<!--
    index.html
    Main entry point for Mark Trewren's personal/professional site.
    Contains hero, about, work, gallery, and fitness sections.
    TODO: Modularize sections into partials/components if the file grows.
    Note: Consider further accessibility improvements (keyboard navigation, ARIA labels) in future.
-->
<!DOCTYPE html>
<!-- Last deployment check: 2024-03-19 -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Mark Trewren | Developer & Athlete</title>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9MHS7QS2VQ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-9MHS7QS2VQ');
    </script>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHJlY3Qgd2lkdGg9IjUxMiIgaGVpZ2h0PSI1MTIiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCB4PSIyNTYiIHk9IjMyMCIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjI0MCIgZm9udC13ZWlnaHQ9ImJvbGQiIGZpbGw9IiNCQkYzNEMiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGRvbWluYW50LWJhc2VsaW5lPSJtaWRkbGUiPk1UPC90ZXh0Pjwvc3ZnPg==">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000">
    <meta name="msapplication-TileColor" content="#000000">
    
    <!-- Enhanced SEO Meta Tags -->
    <meta name="description" content="Mark Trewren - Developer and athlete specializing in web development and endurance sports.">
    <meta name="keywords" content="Mark Trewren, developer, athlete, HYROX, web development">
    <meta name="author" content="Mark Trewren">
    
    <!-- Open Graph / Social Media -->
    <meta property="og:title" content="Mark Trewren | Developer & Athlete">
    <meta property="og:description" content="Developer and athlete specializing in web development and endurance sports.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://marktrewren.com">
    
    <!-- Styles -->
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        .loading-placeholder {
            min-height: 200px;
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 8px;
        }
        
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        .section-transition {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.6s ease;
        }
        
        .section-transition.active {
            opacity: 1;
            transform: translateY(0);
        }

        .activity-github-graph .day-label {
            fill: #fff;
            font-size: 16px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <header class="header" role="banner">
        <div class="header-content">
            <a href="#" class="site-title">Mark Trewren</a>
            <nav role="navigation" aria-label="Main navigation">
                <ul class="nav-links">
                    <li><a href="#about">About</a></li>
                    <li><a href="#projects">Projects</a></li>
                    <li><a href="#training">Training</a></li>
                    <li><a href="#activity-timeline">Timeline</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main id="main-content" role="main">
        <!-- Hero Section -->
        <section class="hero section-transition">
            <div class="hero-background" style="background: url('images-for-journey/hyrox berlin running.jpg') center center / cover no-repeat, #000;">
                <div class="gradient-overlay" style="background: linear-gradient(135deg, rgba(0,0,0,0.6) 0%, rgba(0,0,0,0.5) 100%);"></div>
            </div>
            <div class="hero-content container">
                <h2 class="hero-title"><span id="typewriter">AI Developer & Athlete</span></h2>
                <p class="hero-subtitle" style="font-size:1.5rem; margin-bottom:2rem;">Passionate about training for Hyrox <br>and <a href="#hyrox" style="color: inherit; text-decoration: underline;">building useful fitness related projects.</a></p>
                <div class="race-countdown-container">
                    <div class="race-label">Next Race: <span class="race-name">Hyrox Maastricht</span> <span class="race-date">19th September, 2025</span></div>
                    <div id="race-countdown" class="race-countdown"></div>
                </div>
            </div>
        </section>

        <section id="about" class="section section-transition">
            <div class="container">
                <h2 class="section-title">
                    <i class="fas fa-user"></i>
                    About
                </h2>
                <div class="about-content" style="display: flex; flex-wrap: wrap; align-items: center; gap: 2rem;">
                    <div class="profile-image" style="flex: 1 1 350px; min-width: 300px; display: flex; align-items: center; justify-content: center;">
                        <img src="images-for-journey/Hyrox Berlin, 2025.jpg" alt="Hyrox Berlin, 2025" style="max-width: 100%; max-height: 420px; object-fit: contain; display: block; margin: 0 auto;">
                    </div>
                    <div class="about-text" style="flex: 2 1 400px; min-width: 300px;">
                        <p>üëã Mark here -- dad-in-training, code-curious, always trying to move forward.</p>
                        <p>Dabbled in several endurance races and wandered to some far-flung places from Yemen to Japan to Nicaragua. Always curious, always trying to move forward.</p>
                        <p>Worked as a chartered surveyor, teacher and now taking a swing at startup life. Recently, I learned to code with AI, and now I ship Hyrox products I need - maybe you do too.</p>
                        <p>Inspired by quiet builders and laptop freedom: Levels, Friks, and Lou üíª.</p>
                        <p>When I'm not coding, I'm training for Hyrox or knee-deep in a LEGO mission with the kids.</p>
                        <p>üëá Take a peek at what I've built - or say hello here: mark@stellarapp.ai</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- HYROX Section -->
        <section id="hyrox" class="section section-transition">
            <div class="container">
                <h2 class="section-title">
                    <i class="fas fa-laptop-code"></i>
                    Projects
                </h2>
                <p class="section-subtitle" style="margin-top: -1rem; margin-bottom: 2rem; color: var(--text-secondary);">These are my current projects. I hope you like them.</p>
                <div class="projects-grid">
                    <div class="project-card">
                        <div class="project-status">Live in the App Store</div>
                        <h3>Longevity Tracker</h3>
                        <p><a href="https://stellarapp.ai" target="_blank" style="color: var(--accent-color); text-decoration: none; font-weight: 600;">stellarapp.ai</a></p>
                        <p>An AI-powered longevity tracker</p>
                        <div class="project-features">
                            <span>Activity tracking</span>
                            <span>Sleep tracking</span>
                            <span>Nutrition tracking</span>
                            <span>Powerful AI insights</span>
                        </div>
                    </div>
                    <div class="project-card">
                        <div class="project-status">In development</div>
                        <h3>Daily Stack</h3>
                        <p>Stack wins daily: auto post to Insta when you've hit the gym, coded, and slept well.</p>
                        <div class="project-features">
                            <span>Earned Sharing</span>
                            <span>Social Proof</span>
                            <span>Habit Reinforcement</span>
                        </div>
                    </div>
                    <div class="project-card">
                        <div class="project-status">In development</div>
                        <h3>Magic Shopping List AI</h3>
                        <p><a href="https://hybridgearai.com" target="_blank" style="color: var(--accent-color); text-decoration: none; font-weight: 600;">hybridgearai.com</a></p>
                        <p>Add Hyrox products to your shopping list and then let the AI bot search the web, notifying you when it finds a cheaper price!</p>
                        <div class="project-features">
                            <span>Location-based optimisation</span>
                            <span>One click set up</span>
                        </div>
                    </div>
                    <div class="project-card">
                        <div class="project-status">In development</div>
                        <h3>Sleep Scanner AI</h3>
                        <p><a href="https://sleepscanai.com" target="_blank" style="color: var(--accent-color); text-decoration: none; font-weight: 600;">sleepscanai.com</a></p>
                        <p>Upload a short video of your sleeping environment and optimise your sleep with AI recommendations</p>
                        <div class="project-features">
                            <span>Light Pollution</span>
                            <span>Feng Shui</span>
                            <span>Noise Pollution</span>
                        </div>
                    </div>
                    <div class="project-card">
                        <div class="project-status">In development</div>
                        <h3>Hyrox game</h3>
                        <p><a href="https://hygame.com" target="_blank" style="color: var(--accent-color); text-decoration: none; font-weight: 600;">hygame.com</a></p>
                        <p>A multiplay game where you take on the Hyrox stations against your friends.</p>
                        <div class="project-features">
                            <span>Multiplayer</span>
                            <span>Hyrox stations</span>
                            <span>Fun to play when not training!</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Training Section with Tabs -->
        <section id="training" class="section section-transition">
            <div class="container">
                <h2 class="section-title">
                    <i class="fas fa-dumbbell"></i>
                    Training
                </h2>

                <!-- Tabs -->
                <div class="tabs-container">
                    <div class="tabs-nav">
                        <button class="tab-button active" data-tab="biomarkers">Metrics</button>
                        <button class="tab-button" data-tab="schedule">Schedule</button>
                        <button class="tab-button" data-tab="supplements">Supplements</button>
                    </div>

                    <!-- Tab Content -->
                    <div class="tabs-content">
                        <div id="biomarkers" class="tab-pane active">
                            <h3 class="section-subtitle">Current metrics üìä</h3>
                            <div class="biomarkers-content training-schedule">
                                <div class="schedule-grid">
                                    <div class="schedule-day">
                                        <h4>VO2 Max</h4>
                                        <div class="training-cardio">63 ml/kg/min <span class="timestamp">(4/5)</span></div>
                                        <div class="progress-bar"><div class="progress" style="width: 80%" aria-valuenow="4" aria-valuemax="5" aria-label="VO2 Max"></div></div>
                                    </div>
                                    <div class="schedule-day">
                                        <h4>Resting Heart Rate (RHR)</h4>
                                        <div class="training-cardio">42 BPM <span class="timestamp">(4/5)</span></div>
                                        <div class="progress-bar"><div class="progress" style="width: 80%" aria-valuenow="4" aria-valuemax="5" aria-label="RHR"></div></div>
                                    </div>
                                    <div class="schedule-day">
                                        <h4>Trap bar deadlift</h4>
                                        <div class="training-cardio">110kg @77kg BW <span class="timestamp">(2/5)</span></div>
                                        <div class="progress-bar"><div class="progress" style="width: 40%" aria-valuenow="2" aria-valuemax="5" aria-label="Trap bar deadlift"></div></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="schedule" class="tab-pane">
                            <h3 class="section-subtitle">Training Schedule üèãÔ∏è‚Äç‚ôÇÔ∏è</h3>
                            <div class="training-content">
                                <div class="training-schedule">
                                    <div class="schedule-grid">
                                        <div class="schedule-day strength-day">
                                            <h4>Monday</h4>
                                            <div class="training-strength">Strength, core and wall ball finisher - 60' + rowing - 30'</div>
                                        </div>
                                        <div class="schedule-day cardio-day">
                                            <h4>Tuesday</h4>
                                            <div class="training-cardio">Tennis or rest day</div>
                                        </div>
                                        <div class="schedule-day hiit-day">
                                            <h4>Wednesday</h4>
                                            <div class="training-hiit">Run, speed work at the track - 60'</div>
                                        </div>
                                        <div class="schedule-day cardio-day">
                                            <h4>Thursday</h4>
                                            <div class="training-strength">Strength and wall ball finisher</div>
                                        </div>
                                        <div class="schedule-day strength-day">
                                            <h4>Friday</h4>
                                            <div class="training-cardio">Early Run 60-80' + pm HIIT + core</div>
                                        </div>
                                        <div class="schedule-day cardio-day">
                                            <h4>Saturday</h4>
                                            <div class="training-cardio">Tennis - 60'</div>
                                        </div>
                                        <div class="schedule-day hyrox-day">
                                            <h4>Sunday</h4>
                                            <div class="training-hyrox">Alternating Hyrox - 90' / long run with speed work</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="supplements" class="tab-pane">
                             <h3 class="section-subtitle">Supplements üíä</h3>
                             <div class="training-schedule">
                                 <div class="schedule-grid">
                                     <!-- Morning Stack -->
                                     <div class="schedule-day strength-day">
                                         <h4>
                                             <i class="fas fa-sun"></i>
                                             Morning Stack üåÖ
                                         </h4>
                                         <div class="training-strength">
                                             <div class="supplement-item">
                                                 <span class="supplement-name">ü•§ Beetroot Extract</span>
                                                 <span class="supplement-dosage">3000mg</span>
                                             </div>
                                         </div>
                                     </div>

                                     <!-- Post-Workout -->
                                     <div class="schedule-day cardio-day">
                                         <h4>
                                             <i class="fas fa-blender"></i>
                                             Post-Workout ü•§
                                         </h4>
                                         <div class="training-cardio">
                                             <div class="supplement-item">
                                                 <span class="supplement-name">ü•õ Whey Protein (Grass-Fed) - unflavoured</span>
                                                 <span class="supplement-dosage">30g</span>
                                             </div>
                                             <div class="supplement-item">
                                                 <span class="supplement-name">üí™ Creatine Monohydrate - unflavoured</span>
                                                 <span class="supplement-dosage">5g</span>
                                             </div>
                                             <div class="supplement-item">
                                                 <span class="supplement-name">üßÇ Himalayan Pink Salt</span>
                                                 <span class="supplement-dosage">1/4 tsp *depending on time of year and intensity of the session</span>
                                             </div>
                                             <div class="supplement-item">
                                                 <span class="supplement-name">ü•• Coconut Water - bio</span>
                                                 <span class="supplement-dosage">1/2 cup</span>
                                             </div>
                                             <div class="supplement-item">
                                                 <span class="supplement-name">üçØ Honey</span>
                                                 <span class="supplement-dosage">1 tbsp</span>
                                             </div>
                                             <div class="supplement-item">
                                                 <span class="supplement-name">üçã Lemon Juice</span>
                                                 <span class="supplement-dosage">Half a lemon</span>
                                             </div>
                                             <div class="supplement-item">
                                                 <span class="supplement-name">ü•¨ Kale / Spinach leaves</span>
                                                 <span class="supplement-dosage">Handful</span>
                                             </div>
                                             <div class="supplement-item">
                                                 <span class="supplement-name">üçç Pineapple Chunks</span>
                                                 <span class="supplement-dosage">1/2 cup</span>
                                             </div>
                                             <div class="supplement-item">
                                                 <span class="supplement-name">üíß Water</span>
                                                 <span class="supplement-dosage">1/2 cup (or more)</span>
                                             </div>
                                         </div>
                                     </div>

                                     <!-- Sleep Stack -->
                                     <div class="schedule-day hiit-day">
                                         <h4>
                                             <i class="fas fa-moon"></i>
                                             Sleep Stack üò¥
                                         </h4>
                                         <div class="training-hiit">
                                             <div class="supplement-item">
                                                 <span class="supplement-name">üçí Montmorency Cherry</span>
                                                 <span class="supplement-dosage">1000mg</span>
                                             </div>
                                             <div class="supplement-item">
                                                 <span class="supplement-name">üå∫ Saffron</span>
                                                 <span class="supplement-dosage">28mg (every other day)</span>
                                             </div>
                                             <div class="supplement-item">
                                                 <span class="supplement-name">üß† L-Theanine</span>
                                                 <span class="supplement-dosage">200mg</span>
                                             </div>
                                             <div class="supplement-item">
                                                 <span class="supplement-name">üßÇ Magnesium Glycinate</span>
                                                 <span class="supplement-dosage">300mg (every other day)</span>
                                             </div>
                                         </div>
                                     </div>
                                 </div>
                             </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Combined Activity Timeline Section -->
        <section id="activity-timeline" class="section section-transition">
            <div class="container">
                <h2 class="section-title"><i class="fas fa-stream"></i> Timeline</h2>
                <div id="timeline-filter" style="margin-bottom:1rem;">
                    <button class="timeline-filter-btn active" data-source="all">All</button>
                    <button class="timeline-filter-btn" data-source="strava">
                        <img src="https://cdn.jsdelivr.net/npm/simple-icons@v5/icons/strava.svg" alt="Strava" style="width: 20px; height: 20px; filter: invert(1);">
                    </button>
                    <button class="timeline-filter-btn" data-source="github">
                        <img src="https://cdn.jsdelivr.net/npm/simple-icons@v5/icons/github.svg" alt="GitHub" style="width: 20px; height: 20px; filter: invert(1);">
                    </button>
                </div>

                <!-- GitHub Overview (Initially Hidden) -->
                <div id="github-overview" style="display: none; margin-bottom: 2rem;">
                    <!-- GitHub Contribution Graph -->
                    <div class="activity-github-graph" style="display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <h3 class="section-subtitle">GitHub Contributions (Last Year)</h3>
                        <img src="https://ghchart.rshah.org/AllBlazing" alt="GitHub Contributions Chart" style="width:100%;max-width:800px;background:#222;border-radius:8px;display:block;margin:0 auto;">
                    </div>
                </div>

                <!-- Strava Overview (Initially Hidden) -->
                <div id="strava-overview" style="display: none; margin-bottom: 2rem;">
                    <h3 class="section-subtitle">Strava Monthly Stats</h3>
                    <div class="activity-stats training-schedule">
                        <div class="schedule-grid">
                            <div class="schedule-day stat-card">
                                <h4>Distance</h4>
                                <div class="training-cardio" id="total-distance">Loading...</div>
                            </div>
                            <div class="schedule-day stat-card">
                                <h4>Time</h4>
                                <div class="training-cardio" id="total-time">Loading...</div>
                            </div>
                            <div class="schedule-day stat-card">
                                <h4>Elevation</h4>
                                <div class="training-cardio" id="elevation-gain">Loading...</div>
                            </div>
                            <div class="schedule-day stat-card">
                                <h4>Activities</h4>
                                <div class="training-cardio" id="activity-count">Loading...</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="activity-timeline-vertical">
                    <div id="activity-timeline-feed"></div>
                </div>

                <!-- Journey Gallery -->
                <div id="journey-gallery" class="gallery-container" style="margin-top: 3rem;">
                    <h3 class="section-subtitle" style="margin-bottom: 2rem;">Journey Highlights</h3>
                    <button class="gallery-nav prev" aria-label="Previous image">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <div class="gallery-grid">
                        <!-- Gallery items will be dynamically added here, limited to 4 visible at a time -->
                    </div>
                    <button class="gallery-nav next" aria-label="Next image">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </section>

        <!-- Newsletter Section -->
        <section class="newsletter-section">
            <div class="container">
                <h2>Stay Updated</h2>
                <p>Get notified about new projects and training insights</p>
                <form 
                    name="newsletter" 
                    method="POST" 
                    data-netlify="true" 
                    netlify-honeypot="bot-field" 
                    action="/success" 
                    class="newsletter-form"
                >
                    <input type="hidden" name="form-name" value="newsletter" />
                    <p class="hidden">
                        <label>Don't fill this out if you're human: <input name="bot-field" /></label>
                    </p>
                    <div class="newsletter-input-group">
                        <input type="email" name="email" placeholder="Enter your email" required>
                        <button type="submit" class="subscribe-btn">
                            <i class="fas fa-paper-plane"></i>
                            Subscribe
                        </button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Stats Section -->
    </main>

    <!-- Footer -->
    <footer class="footer" role="contentinfo">
        <div class="footer-content">
            <span class="last-updated" style="display:block;color:rgba(255,255,255,0.7);font-size:0.8rem;margin-top:0.2em;text-align:left;min-width:120px;">Last updated: June 19, 2025</span>
            <span class="copyright" style="display:block;color:rgba(255,255,255,0.7);font-size:1rem;width:100%;text-align:center;">&copy; 2025 Mark Trewren</span>
            <div class="social-links">
                <a href="https://www.strava.com/athletes/31036221" target="_blank" aria-label="Strava">
                    <i class="fab fa-strava"></i>
                </a>
                <a href="https://github.com/AllBlazing" target="_blank" aria-label="GitHub">
                    <i class="fab fa-github"></i>
                </a>
                <a href="https://x.com/trewrenmark?s=21&t=DTOIGbJ-1hUnW2q2Go9hbg" target="_blank" aria-label="X (Twitter)">
                    <i class="fab fa-x-twitter"></i>
                </a>
            </div>
        </div>
    </footer>
    <!-- End Footer -->

    <!-- Scripts -->
    <!-- All scripts loaded at the end for performance -->
    <script defer src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.min.js"></script>
    <script src="gallery.js"></script>
    <script src="script.js"></script>

    <!-- Code animation -->
    <script>
        // Code animation
        const codeLines = [
            'const mark = {\n    role: "Vibe Coder & Athlete",\n    focus: ["Web Dev", "HYROX"],\n    location: "Netherlands",\n    currentlyBuilding: "useful tools",\n    currentlyTraining: "for next PR"\n};',
            'const projects = {\n    HyTracker: "Fitness tracking app",\n    ScanSleepAI: "Sleep optimization",\n    WishListExtAI: "Shopping assistant"\n};',
            'const stats = {\n    VO2Max: 60,\n    PullUps: 19,\n    Countries: 90+\n};'
        ];
        
        let currentLine = 0;
        const codeElement = document.querySelector('.code-animation');
        
        if (codeElement) {
            function animateCode() {
                codeElement.textContent = codeLines[currentLine];
                currentLine = (currentLine + 1) % codeLines.length;
            }
            
            animateCode();
            setInterval(animateCode, 3000);
        }

        // Scroll progress indicator
        window.addEventListener('scroll', () => {
            const scrollProgress = document.querySelector('.scroll-progress');
            if (scrollProgress) {
                const scrollHeight = document.documentElement.scrollHeight - window.innerHeight;
                const scrolled = (window.scrollY / scrollHeight) * 100;
                scrollProgress.style.width = scrolled + '%';
            }
        });
    </script>

    <!-- Interactive metric cards -->
    <script>
        document.querySelectorAll('.metric-card.interactive').forEach(card => {
            if (card) {
                card.addEventListener('mouseenter', function() {
                    const history = this.querySelector('.metric-history');
                    if (history) {
                        history.style.display = 'block';
                        if (!history.dataset.initialized) {
                            const canvas = history.querySelector('canvas');
                            if (canvas) {
                                const ctx = canvas.getContext('2d');
                                new Chart(ctx, {
                                    type: 'line',
                                    data: {
                                        labels: ['Jan', 'Feb', 'Mar', 'Apr'],
                                        datasets: [{
                                            label: canvas.id === 'vo2maxChart' ? 'VO2Max' : 'Pull-ups',
                                            data: [55, 57, 58, 60],
                                            borderColor: 'var(--accent-color)',
                                            tension: 0.1
                                        }]
                                    },
                                    options: {
                                        responsive: true,
                                        maintainAspectRatio: false
                                    }
                                });
                                history.dataset.initialized = true;
                            }
                        }
                    }
                });

                card.addEventListener('mouseleave', function() {
                    const history = this.querySelector('.metric-history');
                    if (history) {
                        history.style.display = 'none';
                    }
                });
            }
        });
    </script>

    <!-- Mobile Share Script -->
    <script>
        const mobileShareButton = document.getElementById('mobile-share');
        if (mobileShareButton) {
             mobileShareButton.addEventListener('click', async () => {
                try {
                    if (navigator.share) {
                        await navigator.share({
                            title: 'Mark Trewren | Developer & Athlete',
                            text: 'Check out my personal website',
                            url: window.location.href
                        });
                    } else {
                        // Fallback for browsers that don't support Web Share API
                        const shareUrl = window.location.href;
                        const tempInput = document.createElement('input');
                        document.body.appendChild(tempInput);
                        tempInput.value = shareUrl;
                        tempInput.select();
                        document.execCommand('copy');
                        document.body.removeChild(tempInput);
                        alert('Link copied to clipboard!');
                    }
                } catch (err) {
                    console.error('Error sharing:', err);
                }
            });
        }
    </script>

    <!-- Mobile Navigation Script -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const mobileNav = document.querySelector('.mobile-nav');
            const mobileLinks = document.querySelectorAll('.mobile-nav-link');
            
            if (mobileNav) {
                mobileLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const targetId = link.getAttribute('href');
                        const targetElement = document.querySelector(targetId);
                        
                        if (targetElement) {
                            targetElement.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                        }
                    });
                });
                
                let lastScrollTop = 0;
                window.addEventListener('scroll', () => {
                    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
                    
                    if (scrollTop > lastScrollTop) {
                        mobileNav.style.transform = 'translateY(100%)';
                    } else {
                        mobileNav.style.transform = 'translateY(0)';
                    }
                    
                    lastScrollTop = scrollTop;
                });
            }
        });
    </script>

    <!-- Update current month -->
    <script>
        const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
        const currentMonth = new Date().getMonth();
        const monthElement = document.getElementById('current-month');
        if (monthElement) {
            monthElement.textContent = months[currentMonth];
        }
    </script>

    <!-- Strava script -->
    <script>
        async function getActivitiesFromNetlify() {
            const response = await fetch('/.netlify/functions/strava');
            if (!response.ok) throw new Error('Failed to fetch activities');
            return await response.json();
        }
    </script>
</body>
</html>